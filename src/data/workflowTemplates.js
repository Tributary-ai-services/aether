/**
 * Workflow templates for the template gallery.
 * Each template provides a pre-built workflow definition that users can customize.
 */

export const workflowTemplateCategories = [
  { id: 'all', label: 'All Templates' },
  { id: 'document_processing', label: 'Document Processing' },
  { id: 'compliance_check', label: 'Compliance' },
  { id: 'approval_chain', label: 'Approvals' },
  { id: 'custom', label: 'General' },
];

export const workflowTemplates = [
  {
    id: 'tpl-doc-extract',
    name: 'Document Extraction Pipeline',
    description: 'Upload a document, extract text and metadata, then store results. Ideal for ingesting invoices, contracts, or reports.',
    category: 'document_processing',
    type: 'document_processing',
    tags: ['extraction', 'ocr', 'metadata'],
    steps: [
      {
        name: 'Upload Trigger',
        type: 'process_document',
        order: 1,
        configuration: { source: 'file_upload', accepted_types: ['pdf', 'docx', 'png', 'jpg'] },
        on_success: 'next',
        on_failure: 'abort',
        timeout: 300,
        retry_count: 1,
      },
      {
        name: 'Extract Content',
        type: 'ai_analysis',
        order: 2,
        configuration: { model: 'gpt-4o-mini', task: 'extract_text_and_metadata' },
        on_success: 'next',
        on_failure: 'abort',
        timeout: 600,
        retry_count: 2,
      },
      {
        name: 'Store Results',
        type: 'notification',
        order: 3,
        configuration: { destination: 'database', notify_on_complete: true },
        on_success: 'complete',
        on_failure: 'abort',
        timeout: 120,
        retry_count: 1,
      },
    ],
    triggers: [
      { type: 'upload', name: 'File Upload', configuration: { accepted_types: ['pdf', 'docx', 'png', 'jpg'] } },
    ],
  },
  {
    id: 'tpl-compliance-scan',
    name: 'Compliance Scan',
    description: 'Scan documents for PII, HIPAA violations, and sensitive data. Flag non-compliant content and generate a compliance report.',
    category: 'compliance_check',
    type: 'compliance_check',
    tags: ['pii', 'hipaa', 'gdpr', 'security'],
    steps: [
      {
        name: 'Receive Document',
        type: 'process_document',
        order: 1,
        configuration: { source: 'api' },
        on_success: 'next',
        on_failure: 'abort',
        timeout: 120,
        retry_count: 0,
      },
      {
        name: 'PII Detection',
        type: 'compliance_check',
        order: 2,
        configuration: { checks: ['pii', 'ssn', 'credit_card', 'phone', 'email'] },
        on_success: 'next',
        on_failure: 'abort',
        timeout: 300,
        retry_count: 1,
      },
      {
        name: 'HIPAA Validation',
        type: 'compliance_check',
        order: 3,
        configuration: { checks: ['phi', 'medical_records', 'patient_data'] },
        on_success: 'next',
        on_failure: 'abort',
        timeout: 300,
        retry_count: 1,
      },
      {
        name: 'Generate Report',
        type: 'notification',
        order: 4,
        configuration: { format: 'compliance_report', notify_stakeholders: true },
        on_success: 'complete',
        on_failure: 'abort',
        timeout: 120,
        retry_count: 0,
      },
    ],
    triggers: [
      { type: 'api', name: 'API Trigger', configuration: {} },
      { type: 'schedule', name: 'Daily Scan', configuration: { cron: '0 2 * * *' } },
    ],
  },
  {
    id: 'tpl-approval-chain',
    name: 'Multi-Level Approval',
    description: 'Route documents through a multi-level approval chain with automatic escalation and notifications at each stage.',
    category: 'approval_chain',
    type: 'approval_chain',
    tags: ['approval', 'review', 'escalation'],
    steps: [
      {
        name: 'Submit for Review',
        type: 'process_document',
        order: 1,
        configuration: { status: 'pending_review' },
        on_success: 'next',
        on_failure: 'abort',
        timeout: 60,
        retry_count: 0,
      },
      {
        name: 'Level 1 Approval',
        type: 'approval',
        order: 2,
        configuration: { approver_role: 'team_lead', timeout_hours: 24 },
        conditions: { require_all: false },
        on_success: 'next',
        on_failure: 'abort',
        timeout: 86400,
        retry_count: 0,
      },
      {
        name: 'Level 2 Approval',
        type: 'approval',
        order: 3,
        configuration: { approver_role: 'manager', timeout_hours: 48 },
        conditions: { require_all: true },
        on_success: 'next',
        on_failure: 'abort',
        timeout: 172800,
        retry_count: 0,
      },
      {
        name: 'Notify Requester',
        type: 'notification',
        order: 4,
        configuration: { channels: ['email', 'in_app'], template: 'approval_result' },
        on_success: 'complete',
        on_failure: 'complete',
        timeout: 60,
        retry_count: 1,
      },
    ],
    triggers: [
      { type: 'manual', name: 'Manual Submission', configuration: {} },
    ],
  },
  {
    id: 'tpl-ai-summarize',
    name: 'AI Document Summarization',
    description: 'Automatically summarize uploaded documents using AI, extract key points, and deliver results via notification.',
    category: 'document_processing',
    type: 'document_processing',
    tags: ['ai', 'summary', 'nlp'],
    steps: [
      {
        name: 'Receive Document',
        type: 'process_document',
        order: 1,
        configuration: { source: 'upload' },
        on_success: 'next',
        on_failure: 'abort',
        timeout: 120,
        retry_count: 0,
      },
      {
        name: 'AI Summarization',
        type: 'ai_analysis',
        order: 2,
        configuration: { model: 'gpt-4o', task: 'summarize', max_tokens: 2000 },
        on_success: 'next',
        on_failure: 'abort',
        timeout: 600,
        retry_count: 2,
      },
      {
        name: 'Deliver Summary',
        type: 'notification',
        order: 3,
        configuration: { channels: ['email'], include_summary: true },
        on_success: 'complete',
        on_failure: 'abort',
        timeout: 60,
        retry_count: 1,
      },
    ],
    triggers: [
      { type: 'upload', name: 'File Upload', configuration: {} },
      { type: 'webhook', name: 'Webhook', configuration: {} },
    ],
  },
  {
    id: 'tpl-scheduled-report',
    name: 'Scheduled Compliance Report',
    description: 'Generate and distribute compliance reports on a schedule. Aggregates violations, computes metrics, and emails stakeholders.',
    category: 'compliance_check',
    type: 'compliance_check',
    tags: ['scheduled', 'report', 'compliance'],
    steps: [
      {
        name: 'Aggregate Data',
        type: 'custom',
        order: 1,
        configuration: { query: 'compliance_violations_last_period' },
        on_success: 'next',
        on_failure: 'abort',
        timeout: 300,
        retry_count: 1,
      },
      {
        name: 'Generate Report',
        type: 'ai_analysis',
        order: 2,
        configuration: { model: 'gpt-4o-mini', task: 'compliance_report', format: 'pdf' },
        on_success: 'next',
        on_failure: 'abort',
        timeout: 600,
        retry_count: 2,
      },
      {
        name: 'Distribute Report',
        type: 'notification',
        order: 3,
        configuration: { channels: ['email'], recipients: 'compliance_team' },
        on_success: 'complete',
        on_failure: 'abort',
        timeout: 120,
        retry_count: 1,
      },
    ],
    triggers: [
      { type: 'schedule', name: 'Weekly Schedule', configuration: { cron: '0 8 * * 1' } },
    ],
  },
  {
    id: 'tpl-webhook-processor',
    name: 'Webhook Event Processor',
    description: 'Listen for external webhook events, validate and transform the payload, then route to the appropriate handler.',
    category: 'custom',
    type: 'custom',
    tags: ['webhook', 'api', 'integration'],
    steps: [
      {
        name: 'Validate Payload',
        type: 'custom',
        order: 1,
        configuration: { validation: 'json_schema', schema_id: 'webhook_v1' },
        on_success: 'next',
        on_failure: 'abort',
        timeout: 30,
        retry_count: 0,
      },
      {
        name: 'Transform Data',
        type: 'custom',
        order: 2,
        configuration: { transform: 'jq', expression: '.data | {id, type, payload}' },
        on_success: 'next',
        on_failure: 'abort',
        timeout: 60,
        retry_count: 1,
      },
      {
        name: 'Route to Handler',
        type: 'custom',
        order: 3,
        configuration: { routing: 'type_based' },
        on_success: 'complete',
        on_failure: 'abort',
        timeout: 120,
        retry_count: 2,
      },
    ],
    triggers: [
      { type: 'webhook', name: 'External Webhook', configuration: { method: 'POST' } },
    ],
  },
];
